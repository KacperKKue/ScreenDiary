<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="ScreenDiary.Views.Movies.MovieInfoPage"
             xmlns:viewmodels="clr-namespace:ScreenDiary.ViewModels.Movies"
             Title="About"
             BackgroundColor="{AppThemeBinding Light=White, Dark=#121212}">

    <ScrollView>
        <VerticalStackLayout Spacing="0">

            <Grid HeightRequest="450">
                <Image Source="{Binding Movie.FullPosterUrl}"
                       Aspect="AspectFill"
                       HorizontalOptions="Fill"
                       VerticalOptions="Fill" />

                <BoxView VerticalOptions="End" HeightRequest="150">
                    <BoxView.Background>
                        <LinearGradientBrush EndPoint="0,1">
                            <GradientStop Color="Transparent" Offset="0" />
                            <GradientStop Color="{AppThemeBinding Light=White, Dark=#121212}" Offset="1" />
                        </LinearGradientBrush>
                    </BoxView.Background>
                </BoxView>
            </Grid>

            <VerticalStackLayout Padding="20" Spacing="15" Margin="0,-40,0,0">

                <Label Text="{Binding Movie.Title}"
                       FontSize="28" FontAttributes="Bold"
                       HorizontalTextAlignment="Center"
                       TextColor="{AppThemeBinding Light=#212121, Dark=White}"/>

                <HorizontalStackLayout HorizontalOptions="Center" Spacing="20">
                    <HorizontalStackLayout Spacing="5">
                        <Label Text="ðŸ“…" FontSize="14" VerticalOptions="Center"/>
                        <Label Text="{Binding Movie.ReleaseDate}" TextColor="Gray" FontSize="14" VerticalOptions="Center"/>
                    </HorizontalStackLayout>

                    <Border Padding="8,4" StrokeShape="RoundRectangle 8" BackgroundColor="#FFC107" StrokeThickness="0" IsVisible="{Binding ShowRatings}">
                        <Label Text="{Binding Movie.VoteAverage, StringFormat='TMDB {0:F1}'}" 
                               TextColor="Black" FontAttributes="Bold" FontSize="12"/>
                    </Border>
                </HorizontalStackLayout>

                <Button Text="Save to library"
                        Clicked="Add_Clicked"
                        CornerRadius="25" HeightRequest="55"
                        BackgroundColor="{AppThemeBinding Light={StaticResource Primary}}"
                        TextColor="{StaticResource White}"
                        FontAttributes="Bold" Margin="10,5" />

                <Border StrokeShape="RoundRectangle 15" 
                        Padding="15" 
                        BackgroundColor="{AppThemeBinding Light={StaticResource Gray40}}"
                        StrokeThickness="0">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="YOUR ACTIVITY" FontSize="12" FontAttributes="Bold" TextColor="Gray" />
                        <Label Text="Status:" VerticalOptions="Center" FontAttributes="Bold" />
                        <Grid ColumnDefinitions="Auto, *">
                            <Picker Grid.Column="1" 
                                    ItemsSource="{Binding Statuses}"
                                    SelectedItem="{Binding SelectedStatus}"
                                    HorizontalOptions="End"
                                    FontSize="14" />
                        </Grid>

                        <BoxView HeightRequest="1" Color="LightGray" Opacity="0.2" />

                        <VerticalStackLayout Spacing="5" HorizontalOptions="Center">
                            <toolkit:RatingView
                                EmptyShapeColor="{AppThemeBinding Light=LightGray, Dark=DimGray}"
                                FillColor="{AppThemeBinding Light={StaticResource Secondary}}"
                                FillOption="Shape"
                                IsReadOnly="False"
                                ShapePadding="2"
                                ShapeDiameter="{OnPlatform Android=20, Default=26}"
                                MaximumRating="10"
                                Rating="{Binding UserRating, Mode=TwoWay}"
                                Shape="Star"
                                ShapeBorderThickness="1" />
                        </VerticalStackLayout>

                        <BoxView HeightRequest="1" Color="LightGray" Opacity="0.2" />

                        <VerticalStackLayout Spacing="8">
                            <Label Text="Note:" FontAttributes="Bold" />
                            <Border StrokeShape="RoundRectangle 8" 
                                    StrokeThickness="1" 
                                    Stroke="{AppThemeBinding Light=#E0E0E0, Dark=#333}"
                                    Padding="10,0">
                                <Editor 
                                    Text="{Binding Note}"
                                    Placeholder="What do you think about this movie?"
                                    AutoSize="TextChanges"
                                    MinimumHeightRequest="80"
                                    FontSize="14"
                                    BackgroundColor="Transparent"/>
                            </Border>
                        </VerticalStackLayout>

                    </VerticalStackLayout>
                </Border>

                <BoxView HeightRequest="1" Color="LightGray" Opacity="0.3" Margin="0,10"/>

                <Label Text="Plot description" FontSize="18" FontAttributes="Bold"
                       TextColor="{AppThemeBinding Light=#444, Dark=#EEE}"/>

                <Label Text="{Binding Movie.Overview}" FontSize="16" LineHeight="1.3"
                       TextColor="{AppThemeBinding Light=#333, Dark=#CCC}"/>

            </VerticalStackLayout>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>